import os
import sys
import pdb


SV_PATH = '/Users/numisveinsson/SimVascularProject/SimvascularSrc/Python/site-packages'
sys.path.append(SV_PATH)

from sv_ml import sv_wrapper

NET_FN = "googlenet_c30_train300k_aug10_clean"
#IMAGE_FN = "/Users/numisveinsson/SimVascularProject/SimvascularSrc/Python/site-packages/sv_ml/my_image.vti" #also supports .mha and DICOM

IMAGE_FN = "/Users/numisveinsson/Documents/Berkeley/Research/SimVascular/cases/0075_1001/Images/OSMSC0075-cm.vti"
sw = sv_wrapper.SVWrapper(NET_FN)

sw.set_image(IMAGE_FN)

import json

d = {
    "p":[0.0,0.0,0.0], #path point
    "n":[1.0,0.0,0.0], #normal to the cross-sectional plane
    "tx":[0.0,1.0,0.0] #tangent to the cross-sectional plane
}

d_s = json.dumps(d)
#pdb.set_trace()

ctr_pts_s = sw.segment(d_s)

#pdb.set_trace()
ctr_pts = json.loads(ctr_pts_s)

print('')
print('The prediction is:')
print(ctr_pts['points'])
print('')


import factories.postprocessor_factory as postpro_factory

postprocessor = postpro_factory.get(config)

pdb.set_trace()
